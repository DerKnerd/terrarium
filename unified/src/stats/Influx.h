//
// Created by imanuel on 23.03.21.
//

#ifndef UNIFIED_INFLUX_H
#define UNIFIED_INFLUX_H

#include "Symbols.h"
#include "InfluxInfo.h"
#include "WhoIsThis.h"
#include <string>
#include <WiFiMulti.h>
#include <HTTPClient.h>
#include <InfluxDbClient.h>
#include <FS.h>
#include <Arduino.h>

using std::string;

class Influx {
public:
    auto setup() -> void;

    auto postToInflux(float hotSideTemp, float coldSideTemp) -> void;

    auto getInfluxServer() -> String;

private:
    InfluxDBClient client{INFLUXDB_URL, INFLUXDB_ORG, INFLUXDB_BUCKET, INFLUXDB_AUTH_TOKEN, RootCA.c_str()};
    Point sensor{"terrarium_temperature"};
    const string RootCA{R"EOF(
-----BEGIN CERTIFICATE-----
MIIFLzCCBBegAwIBAgISA67RN1mcePIPoGz+f9vtKPRHMA0GCSqGSIb3DQEBCwUA
MDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MQswCQYDVQQD
EwJSMzAeFw0yMTA1MDExNjExNTJaFw0yMTA3MzAxNjExNTJaMCAxHjAcBgNVBAMT
FWluZmx1eC5zdGF0aXN0aWNhbC5saTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC
AQoCggEBAMdOVwo8i8O8MvsapSEwgfaqHW242T8woL78NGfoPVVJHBK0tlsU++XR
Gyt9MRuRXPtYmpaGT+0iI6i8LMt7P1OsuQ2IYDP7Zvbqte+oFuqEl80PcdqpQ8yK
EPsY3uxoCxGJL8AUvOdubckAJ1GU82zoJxIcRBNa4bebcdPZ9srN803d8nuNHwgv
Pf+1RdeqMtsKmZb3nYLUFfJQx5AasRiwXHm/bNG4K4O+kOFPEYvXuWQX+tyybqcj
aup6aBaqkYLlRZnF6hMrmDYcO55QKsGr5EYafEBu8ZvGn0LvXsLsvriKzsq03nAH
ZUqEND0c6r+NfQaUx46iIdQJS7WEUO8CAwEAAaOCAk8wggJLMA4GA1UdDwEB/wQE
AwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIw
ADAdBgNVHQ4EFgQUB7h6r9usoA2Us8h+IWQJdiHP72swHwYDVR0jBBgwFoAUFC6z
F7dYVsuuUAlA5h+vnYsUwsYwVQYIKwYBBQUHAQEESTBHMCEGCCsGAQUFBzABhhVo
dHRwOi8vcjMuby5sZW5jci5vcmcwIgYIKwYBBQUHMAKGFmh0dHA6Ly9yMy5pLmxl
bmNyLm9yZy8wIAYDVR0RBBkwF4IVaW5mbHV4LnN0YXRpc3RpY2FsLmxpMEwGA1Ud
IARFMEMwCAYGZ4EMAQIBMDcGCysGAQQBgt8TAQEBMCgwJgYIKwYBBQUHAgEWGmh0
dHA6Ly9jcHMubGV0c2VuY3J5cHQub3JnMIIBAwYKKwYBBAHWeQIEAgSB9ASB8QDv
AHUAb1N2rDHwMRnYmQCkURX/dxUcEdkCwQApBo2yCJo32RMAAAF5KOpGKgAABAMA
RjBEAiAxugT4ff9WUEXnzdeErLrNmWhTOeII1gNFrqdRQLco5wIgH5+uHj8hRIT0
mmZZhb9hXLS3H5J3ZMu6skYNPy2+EEEAdgD2XJQv0XcwIhRUGAgwlFaO400TGTO/
3wwvIAvMTvFk4wAAAXko6kX9AAAEAwBHMEUCIQDHAjjKHwZCSZGixPOr0GZbYsNk
8mbgKaEmAvgbbUizlwIgA044oaBYUEYO5oF21OKm5LYazhxtoPWFkH7JeLn14dow
DQYJKoZIhvcNAQELBQADggEBADZoukYeM82qr02EXhe5v2KhTsG2Iax085cUtQiI
a1RUqTb8nWobWsZpL6Atx18KmDIgGyiGpnAZV+g0bUF3eb/9Fxtrfsq9FkgSYPTb
XjD3sblFND5BHZPcwQN+7czh0oybd+OqfcpDAausIFYi4LfgyNJeGZ7ANKs88Jc0
alXiuKYku2/qMy0TJ+Zhql+Aryz5aVsb+iYGKfVbgY8tAzM6GararF0PAl629u0s
W8T0THyXn9Xia8UZ6g40YFzdtutXqV7dcHmsl0Gabc84lgrJbe94zcu6ya9enVGk
Aebb+DgY8LN3hTy+RMiIDHm3I2liFqy9L5MHABWCtZ5X9gA=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIEZTCCA02gAwIBAgIQQAF1BIMUpMghjISpDBbN3zANBgkqhkiG9w0BAQsFADA/
MSQwIgYDVQQKExtEaWdpdGFsIFNpZ25hdHVyZSBUcnVzdCBDby4xFzAVBgNVBAMT
DkRTVCBSb290IENBIFgzMB4XDTIwMTAwNzE5MjE0MFoXDTIxMDkyOTE5MjE0MFow
MjELMAkGA1UEBhMCVVMxFjAUBgNVBAoTDUxldCdzIEVuY3J5cHQxCzAJBgNVBAMT
AlIzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuwIVKMz2oJTTDxLs
jVWSw/iC8ZmmekKIp10mqrUrucVMsa+Oa/l1yKPXD0eUFFU1V4yeqKI5GfWCPEKp
Tm71O8Mu243AsFzzWTjn7c9p8FoLG77AlCQlh/o3cbMT5xys4Zvv2+Q7RVJFlqnB
U840yFLuta7tj95gcOKlVKu2bQ6XpUA0ayvTvGbrZjR8+muLj1cpmfgwF126cm/7
gcWt0oZYPRfH5wm78Sv3htzB2nFd1EbjzK0lwYi8YGd1ZrPxGPeiXOZT/zqItkel
/xMY6pgJdz+dU/nPAeX1pnAXFK9jpP+Zs5Od3FOnBv5IhR2haa4ldbsTzFID9e1R
oYvbFQIDAQABo4IBaDCCAWQwEgYDVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8E
BAMCAYYwSwYIKwYBBQUHAQEEPzA9MDsGCCsGAQUFBzAChi9odHRwOi8vYXBwcy5p
ZGVudHJ1c3QuY29tL3Jvb3RzL2RzdHJvb3RjYXgzLnA3YzAfBgNVHSMEGDAWgBTE
p7Gkeyxx+tvhS5B1/8QVYIWJEDBUBgNVHSAETTBLMAgGBmeBDAECATA/BgsrBgEE
AYLfEwEBATAwMC4GCCsGAQUFBwIBFiJodHRwOi8vY3BzLnJvb3QteDEubGV0c2Vu
Y3J5cHQub3JnMDwGA1UdHwQ1MDMwMaAvoC2GK2h0dHA6Ly9jcmwuaWRlbnRydXN0
LmNvbS9EU1RST09UQ0FYM0NSTC5jcmwwHQYDVR0OBBYEFBQusxe3WFbLrlAJQOYf
r52LFMLGMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjANBgkqhkiG9w0B
AQsFAAOCAQEA2UzgyfWEiDcx27sT4rP8i2tiEmxYt0l+PAK3qB8oYevO4C5z70kH
ejWEHx2taPDY/laBL21/WKZuNTYQHHPD5b1tXgHXbnL7KqC401dk5VvCadTQsvd8
S8MXjohyc9z9/G2948kLjmE6Flh9dDYrVYA9x2O+hEPGOaEOa1eePynBgPayvUfL
qjBstzLhWVQLGAkXXmNs+5ZnPBxzDJOLxhF2JIbeQAcH5H0tZrUlo5ZYyOqA7s9p
O5b85o3AM/OJ+CktFBQtfvBhcJVd9wvlwPsk+uyOy2HI7mNxKKgsBTt375teA2Tw
UdHkhVNcsAKX1H7GNNLOEADksd86wuoXvg==
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIDSjCCAjKgAwIBAgIQRK+wgNajJ7qJMDmGLvhAazANBgkqhkiG9w0BAQUFADA/
MSQwIgYDVQQKExtEaWdpdGFsIFNpZ25hdHVyZSBUcnVzdCBDby4xFzAVBgNVBAMT
DkRTVCBSb290IENBIFgzMB4XDTAwMDkzMDIxMTIxOVoXDTIxMDkzMDE0MDExNVow
PzEkMCIGA1UEChMbRGlnaXRhbCBTaWduYXR1cmUgVHJ1c3QgQ28uMRcwFQYDVQQD
Ew5EU1QgUm9vdCBDQSBYMzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB
AN+v6ZdQCINXtMxiZfaQguzH0yxrMMpb7NnDfcdAwRgUi+DoM3ZJKuM/IUmTrE4O
rz5Iy2Xu/NMhD2XSKtkyj4zl93ewEnu1lcCJo6m67XMuegwGMoOifooUMM0RoOEq
OLl5CjH9UL2AZd+3UWODyOKIYepLYYHsUmu5ouJLGiifSKOeDNoJjj4XLh7dIN9b
xiqKqy69cK3FCxolkHRyxXtqqzTWMIn/5WgTe1QLyNau7Fqckh49ZLOMxt+/yUFw
7BZy1SbsOFU5Q9D8/RhcQPGX69Wam40dutolucbY38EVAjqr2m7xPi71XAicPNaD
aeQQmxkqtilX4+U9m5/wAl0CAwEAAaNCMEAwDwYDVR0TAQH/BAUwAwEB/zAOBgNV
HQ8BAf8EBAMCAQYwHQYDVR0OBBYEFMSnsaR7LHH62+FLkHX/xBVghYkQMA0GCSqG
SIb3DQEBBQUAA4IBAQCjGiybFwBcqR7uKGY3Or+Dxz9LwwmglSBd49lZRNI+DT69
ikugdB/OEIKcdBodfpga3csTS7MgROSR6cz8faXbauX+5v3gTt23ADq1cEmv8uXr
AvHRAosZy5Q6XkjEGB5YGV8eAlrwDPGxrancWYaLbumR9YbK+rlmM6pZW87ipxZz
R8srzJmwN0jP41ZL9c8PDHIyh8bwRLtTcm1D9SZImlJnt1ir/md2cXjbDaJWFBM5
JDGFoqgCWjBH4d1QB7wCCZAA62RjYJsWvIjJEubSfZGL+T0yjWW06XyxV3bqxbYo
Ob8VZRzI9neWagqNdwvYkQsEjgfbKbYK7p2CNTUQ
-----END CERTIFICATE-----
)EOF"};
};


#endif //UNIFIED_INFLUX_H
